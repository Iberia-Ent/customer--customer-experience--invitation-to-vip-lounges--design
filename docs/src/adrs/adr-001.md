# ADR-001: Send QR Code to CRM External system

- ***Status***:  ACCEPTED 
- ***Deciders***: José Salcedo
- ***Consulted***: Ildefonso Serrano
- ***Informers***: 

## Decision timeline *(MANDATORY)*


|                                         |            |
| --------------------------------------- | ---------- |
| Submitted on                            | 2025-09-11 |


## Context *(MANDATORY)*

The Invitations manager requires the ability to send an email containing a QR that allows the invited person to access the lounge of fastTrack system. 




### Functional Requirements *(OPTINAL)*

- The QR must be embedded in the email (HTML),  it should not be attached as a separate file.
- The code may be sent months before the fllght, it shouldn't caducate.


### Non-Functional Requirements *(OPTIONAL)*

- The QR image must be generated by the Invitations Manager system because CRM Cloud only handles generic files.

## Decision *(MANDATORY)*

- The Invitations manager will  generate the QR Code image and store it in a private S3 bucket.
- Invitation manager will generate a signed link to QR Code image with caducity and will send to CRM system.
- The CRM System must embed image directly in the email using Base64 codification of the image(the link is not valid due to expiration constraints).

## Additional considerations
- This approach is recommended due to:
    - The expiration  of the signed link.
    - Security concerns , it is preferable not to expose the QR code image to the public internet.


## Related
In meetings involving MKT Cloud and CRM Cloud regarding how to send the message to MKT Cloud it was agreed that the QR code image included in the email should be embedded as Base64 text instead of using a link to s3 bucket (due to expiration and security concerns).


## Evidences
Conversation CX & Mkt cloud:
People involved:

COFO.Salcedo Rojas, José
BABEL.Azaña Alonso, José
cocktail.Correa Caicedo, Laura Johanna
cocktail.Molina Miguel, David
COFO.Cilleruelo Tr
glo.Muscalu, Daniel
glo.Pina Barrios, Sara Margoth
Ibargüen Ribera, María Cristina
LEDA.Pina Gutierrez, Lisbeth Andreina
Ruf, Andreas Franz
Serrano Garcia, Idelfonso
vector.Álvarez Canon, David
viseo.Ayala Leandro, Carlos


Detailed conversation:

COFO.Salcedo Rojas, José

El problema es la expiración de la URL
 
eso es, la invitación puede hacerse días o hasta meses antes del vuelo, y la expiración es limitada. Por eso la importancia de embeder la imagen y no utilizar la URL en el correo.
 
cocktail.Molina Miguel, David

pero eso, como os dije no sería problema. 
Si yo os envio un email hoy con una imagen del qr usando la URL de s3 que me ha compartido David

aunque caduque la imagen del s3, en ese correo vais a ver la imagen para siempre, porque se pinta solo cuando se envia, no se vuelve a cargar cada vez que entras a ver el correo
 
no se si me he explicado bien
 
COFO.Salcedo Rojas, José

perfecto entonces, no te había entendido bien
 




